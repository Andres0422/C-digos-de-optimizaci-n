# C-digos-de-optimizaci-n

*Creacion conjuntos
*** SISTEMA DE 9 NODOS
*** PARA CAMBIAR LA CANTIDAD DE GENERADORES, SOLO SE DEBE MODIFICAR EL VALOR DE LA VARIABLE "NGmax"
*** DE CERO HASTA EL NUMERO MAXIMO DE NODOS.
SETS
i Conjunto de nodos /N1*N9/
gc Conjunto de generadores convencionales /GC1, GC2, GC3/
MAP (gc,i) Realacion GC con el nodo /GC1.N1, GC2.N2, GC3.N3/
T Conjunto de horas del dia /T1*T24/;
ALIAS (i,j);
SCALARS
PGmax Potencia maxima de salida por DG /10/
NGmax DG permitidos /0/
n cargabilidad /0.9/;

*Informacion del sistema
TABLE Y(i,j,*)
           Yij      Phij
N1.N1      6.9444  -1.5708
N4.N1      6.9444   1.5708
N2.N2      8.0000  -1.5708
N7.N2      8.0000   1.5708
N3.N3      11.363  -1.5708
N9.N3      11.363   1.5708
N1.N4      6.9444   1.5708
N4.N4      29.246  -1.4575
N5.N4      11.684   1.6879
N6.N4      10.688   1.7535
N4.N5      11.684   1.6879
N5.N5      17.763  -1.4266
N7.N5      6.0920   1.7670
N4.N6      10.688   1.7535
N6.N6      16.418  -1.3731
N9.N6      5.7334   1.7963
N2.N7      8.0000   1.5708
N5.N7      6.0920   1.7670
N7.N7      27.801  -1.4664
N8.N7      13.781   1.6952
N7.N8      13.781   1.6952
N8.N8      23.613  -1.4490
N9.N8      9.8318   1.6891
N3.N9      11.363   1.5708
N6.N9      5.7334   1.7963
N8.N9      9.8318   1.6891
N9.N9      26.826  -1.4796

*Potencias ya en PU
TABLE DEM(i,*)
      Pd          Qd
N1    0.000       0.000
N2    0.000       0.000
N3    0.000       0.000
N4    0.000       0.000
N5    1.250       0.500
N6    0.900       0.300
N7    0.000       0.000
N8    1.000       0.350
N9    0.000       0.000;


*Uso la misma tabla SOL para el Pload que es la demanda variable en
*las 24 horas para no tener que crear otra variable

TABLE SOL(i,T,*)
           Ps       Pload
N1.T1      0.000    0.765
N2.T1      0.000    0.765
N3.T1      0.000    0.765
N4.T1      0.000    0.765
N5.T1      0.000    0.765
N6.T1      0.000    0.765
N7.T1      0.000    0.765
N8.T1      0.000    0.765
N9.T1      0.000    0.765
N1.T2      0.001    0.736
N2.T2      0.001    0.736
N3.T2      0.001    0.736
N4.T2      0.001    0.736
N5.T2      0.001    0.736
N6.T2      0.001    0.736
N7.T2      0.001    0.736
N8.T2      0.001    0.736
N9.T2      0.001    0.736
N1.T3      0.001    0.714
N2.T3      0.001    0.714
N3.T3      0.001    0.714
N4.T3      0.001    0.714
N5.T3      0.001    0.714
N6.T3      0.001    0.714
N7.T3      0.001    0.714
N8.T3      0.001    0.714
N9.T3      0.001    0.714
N1.T4      0.001    0.712
N2.T4      0.001    0.712
N3.T4      0.001    0.712
N4.T4      0.001    0.712
N5.T4      0.001    0.712
N6.T4      0.001    0.712
N7.T4      0.001    0.712
N8.T4      0.001    0.712
N9.T4      0.001    0.712
N1.T5      0.000    0.698
N2.T5      0.000    0.698
N3.T5      0.000    0.698
N4.T5      0.000    0.698
N5.T5      0.000    0.698
N6.T5      0.000    0.698
N7.T5      0.000    0.698
N8.T5      0.000    0.698
N9.T5      0.000    0.698
N1.T6      0.002    0.688
N2.T6      0.002    0.688
N3.T6      0.002    0.688
N4.T6      0.002    0.688
N5.T6      0.002    0.688
N6.T6      0.002    0.688
N7.T6      0.002    0.688
N8.T6      0.002    0.688
N9.T6      0.002    0.688
N1.T7      0.102    0.677
N2.T7      0.102    0.677
N3.T7      0.102    0.677
N4.T7      0.102    0.677
N5.T7      0.102    0.677
N6.T7      0.102    0.677
N7.T7      0.102    0.677
N8.T7      0.102    0.677
N9.T7      0.102    0.677
N1.T8      0.346    0.710
N2.T8      0.346    0.710
N3.T8      0.346    0.710
N4.T8      0.346    0.710
N5.T8      0.346    0.710
N6.T8      0.346    0.710
N7.T8      0.346    0.710
N8.T8      0.346    0.710
N9.T8      0.346    0.710
N1.T9      0.570    0.753
N2.T9      0.570    0.753
N3.T9      0.570    0.753
N4.T9      0.570    0.753
N5.T9      0.570    0.753
N6.T9      0.570    0.753
N7.T9      0.570    0.753
N8.T9      0.570    0.753
N9.T9      0.570    0.753
N1.T10     0.786    0.791
N2.T10     0.786    0.791
N3.T10     0.786    0.791
N4.T10     0.786    0.791
N5.T10     0.786    0.791
N6.T10     0.786    0.791
N7.T10     0.786    0.791
N8.T10     0.786    0.791
N9.T10     0.786    0.791
N1.T11     0.920    0.829
N2.T11     0.920    0.829
N3.T11     0.920    0.829
N4.T11     0.920    0.829
N5.T11     0.920    0.829
N6.T11     0.920    0.829
N7.T11     0.920    0.829
N8.T11     0.920    0.829
N9.T11     0.920    0.829
N1.T12     0.986    0.861
N2.T12     0.986    0.861
N3.T12     0.986    0.861
N4.T12     0.986    0.861
N5.T12     0.986    0.861
N6.T12     0.986    0.861
N7.T12     0.986    0.861
N8.T12     0.986    0.861
N9.T12     0.986    0.861
N1.T13     1.000    0.879
N2.T13     1.000    0.879
N3.T13     1.000    0.879
N4.T13     1.000    0.879
N5.T13     1.000    0.879
N6.T13     1.000    0.879
N7.T13     1.000    0.879
N8.T13     1.000    0.879
N9.T13     1.000    0.879
N1.T14     0.955    0.877
N2.T14     0.955    0.877
N3.T14     0.955    0.877
N4.T14     0.955    0.877
N5.T14     0.955    0.877
N6.T14     0.955    0.877
N7.T14     0.955    0.877
N8.T14     0.955    0.877
N9.T14     0.955    0.877
N1.T15     0.823    0.868
N2.T15     0.823    0.868
N3.T15     0.823    0.868
N4.T15     0.823    0.868
N5.T15     0.823    0.868
N6.T15     0.823    0.868
N7.T15     0.823    0.868
N8.T15     0.823    0.868
N9.T15     0.823    0.868
N1.T16     0.616    0.856
N2.T16     0.616    0.856
N3.T16     0.616    0.856
N4.T16     0.616    0.856
N5.T16     0.616    0.856
N6.T16     0.616    0.856
N7.T16     0.616    0.856
N8.T16     0.616    0.856
N9.T16     0.616    0.856
N1.T17     0.352    0.845
N2.T17     0.352    0.845
N3.T17     0.352    0.845
N4.T17     0.352    0.845
N5.T17     0.352    0.845
N6.T17     0.352    0.845
N7.T17     0.352    0.845
N8.T17     0.352    0.845
N9.T17     0.352    0.845
N1.T18     0.102    0.834
N2.T18     0.102    0.834
N3.T18     0.102    0.834
N4.T18     0.102    0.834
N5.T18     0.102    0.834
N6.T18     0.102    0.834
N7.T18     0.102    0.834
N8.T18     0.102    0.834
N9.T18     0.102    0.834
N1.T19     0.001    0.834
N2.T19     0.001    0.834
N3.T19     0.001    0.834
N4.T19     0.001    0.834
N5.T19     0.001    0.834
N6.T19     0.001    0.834
N7.T19     0.001    0.834
N8.T19     0.001    0.834
N9.T19     0.001    0.834
N1.T20     0.000    0.951
N2.T20     0.000    0.951
N3.T20     0.000    0.951
N4.T20     0.000    0.951
N5.T20     0.000    0.951
N6.T20     0.000    0.951
N7.T20     0.000    0.951
N8.T20     0.000    0.951
N9.T20     0.000    0.951
N1.T21     0.000    1.000
N2.T21     0.000    1.000
N3.T21     0.000    1.000
N4.T21     0.000    1.000
N5.T21     0.000    1.000
N6.T21     0.000    1.000
N7.T21     0.000    1.000
N8.T21     0.000    1.000
N9.T21     0.000    1.000
N1.T22     0.000    0.924
N2.T22     0.000    0.924
N3.T22     0.000    0.924
N4.T22     0.000    0.924
N5.T22     0.000    0.924
N6.T22     0.000    0.924
N7.T22     0.000    0.924
N8.T22     0.000    0.924
N9.T22     0.000    0.924
N1.T23     0.001    0.869
N2.T23     0.001    0.869
N3.T23     0.001    0.869
N4.T23     0.001    0.869
N5.T23     0.001    0.869
N6.T23     0.001    0.869
N7.T23     0.001    0.869
N8.T23     0.001    0.869
N9.T23     0.001    0.869
N1.T24     0.000    0.765
N2.T24     0.000    0.765
N3.T24     0.000    0.765
N4.T24     0.000    0.765
N5.T24     0.000    0.765
N6.T24     0.000    0.765
N7.T24     0.000    0.765
N8.T24     0.000    0.765
N9.T24     0.000    0.765;


*Creacion de variables
VARIABLES
z funcion objetivo (Perdidas)
V(i,T) Variables de modulo de voltaje
d(i,T) Variables de angulo de voltaje
Pg(gc,T) Potencia activa generada por Gen. Conv.
Qg(gc,T) Potencia reactiva generada por Gen. Conv.
Pdg(i) Potencia activa generada por el DG
Qdg(i,T) Potencia reaactiva generada por el DG;
*limites de las variables
V.lo(i,T) = 0.9;
V.up(i,T) = 1.1;
V.fx('N1',T) = 1.04;
d.fx('N1',T) = 0.00;
V.fx('N2',T) = 1.025;
d.fx('N2',T) = 0.00;
V.fx('N3',T) = 1.025;
d.fx('N3',T) = 0.00;

BINARY VARIABLES
x(i) variable de localización optima del DG;

*Ecuaciones
EQUATIONS
FO Funcion obj.
BalP(i,T) Balance de potencia activa.
BalQ(i,T) Balance de potencia reactiva.
TGEN Numerdo de GD permitida
MAXPGD(i)
MINPGD(i)
MAXQGD(i,T)
MINQGD(i,T);

*Forma de las ecuaciones
FO.. z =E= SUM(T,SUM(i, V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))))));
BalP(i,T).. SUM(GC$MAP(gc,i), Pg(gc,T)) + SOL(i,T,'Ps')*Pdg(i) - SOL(i,T,'Pload')*DEM (i,'Pd') =E= V(i,T)*(SUM (j,V(i,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))));
BalQ(i,T).. SUM(GC$MAP(gc,i), Qg(gc,T)) + qdg(i,T) - SOL(i,T,'Pload')*DEM (i,'Qd') =E= - V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*sin(d(j,T) - d(i,T) + Y(i,j,'Phij'))));

TGEN.. SUM(i,x(i)) =L= NGmax;
MAXPGD(i).. Pdg(i) =G= 0;
MINPGD(i).. Pdg(i) =L= x(i)*PGmax;

MAXQGD(i,T).. qdg(i,T) =G= -(pdg(i)/n)*sqrt(1-(SQR(n*SOL(i,T,'Ps'))));
MINQGD(i,T).. qdg(i,T) =L=  (pdg(i)/n)*sqrt(1-(SQR(n*SOL(i,T,'Ps'))));


MODEL FlujodePot /ALL/;
OPTIONS decimals = 5;
SOLVE FlujodePot us MINLP min z;
DISPLAY V.l, d.l, Pg.l, Qg.l, x.l, pdg.l, qdg.l;



***SISTEMA DE 14 NODOS
*Creacion conjuntos
SETS
i Conjunto de nodos /N1*N14/
gc Conjunto de generadores convencionales /GC1, GC2, GC3/
MAP (gc,i) Realacion GC con el nodo /GC1.N2, GC2.N9, GC3.N11/
T Conjunto de horas del dia /T1*T24/;
ALIAS (i,j);
SCALARS
PGmax Potencia maxima de salida por DG /10/
NGmax DG permitidos /0/
n cargabilidad /0.9/;

*Informacion del sistema
TABLE Y(i,j,*)
            Yij         Phij
N1.N1       76.5014    -1.2568
N2.N1       71.3830     1.8902
N5.N1       5.13447     1.8081
N1.N2       71.3830     1.8902
N2.N2       94.1673    -1.2576
N3.N2       6.51723     1.8036
N4.N2       8.05466     1.8894
N5.N2       8.23498     1.8873
N2.N3       6.51723     1.8036
N3.N3       14.8468    -1.2589
N4.N3       8.36574     1.9441
N2.N4       8.05466     1.8894
N3.N4       8.36574     1.9441
N4.N4       1411.87    -1.2948
N5.N4       1373.60     1.8490
N7.N4       11.1619     1.6512
N9.N4       11.1619     1.6512
N1.N5       5.13447     1.8081
N2.N5       8.23498     1.8873
N4.N5       1373.60     1.8490
N5.N5       1397.91    -1.2939
N6.N5       11.1619     1.6512
N5.N6       11.1619     1.6512
N6.N6       34.0474    -1.2319
N11.N6      5.98420     2.0162
N12.N6      3.61135     2.0186
N13.N6      13.8366     2.0418
N4.N7       11.1619     1.6512
N7.N7       41.3095    -1.5489
N8.N7       8.48176     1.5716
N9.N7       21.6919     1.5707
N7.N8       8.48176     1.5716
N8.N8       8.48176    -1.5699
N4.N9       11.1619     1.6512
N7.N9       21.6919     1.5707
N9.N9       69.4960    -1.3625
N10.N9      34.4238     1.9295
N14.N9      3.25389     2.0104
N9.N10      34.4238     1.9295
N10.N10     40.9677    -1.2048
N11.N10     6.54950     1.9746
N6.N11      5.98420     2.0162
N10.N11     6.54950     1.9746
N11.N11     12.5310    -1.1470
N6.N12      3.61135     2.0186
N12.N12     7.86586    -0.9098
N13.N12     4.40292     2.4060
N6.N13      13.8366     2.0418
N12.N13     4.40292     2.4060
N13.N13     19.9495    -1.0224
N14.N13     1.93930     2.0275
N9.N14      3.25389     2.0104
N13.N14     1.93930     2.0275
N14.N14     5.19301    -1.1247;


*Potencias ya en PU
TABLE DEM(i,*)
      Pd          Qd
N1    0.800       0.100
N2    1.985       0.163
N3    1.710       0.125
N4    0.790       0.219
N5    1.380       0.108
N6    1.160       0.275
N7    0.970       0.420
N8    0.900       0.101
N9    1.475       0.113
N10   1.450       0.129
N11   1.175       0.109
N12   0.230       0.020
N13   0.636       0.129
N14   0.574       0.125;


*Uso la misma tabla SOL para el Pload que es la demanda variable en
*las 24 horas para no tener que crear otra variable

TABLE SOL(i,T,*)
           Ps       Pload
N1.T1      0.000    0.765
N2.T1      0.000    0.765
N3.T1      0.000    0.765
N4.T1      0.000    0.765
N5.T1      0.000    0.765
N6.T1      0.000    0.765
N7.T1      0.000    0.765
N8.T1      0.000    0.765
N9.T1      0.000    0.765
N10.T1     0.000    0.765
N11.T1     0.000    0.765
N12.T1     0.000    0.765
N13.T1     0.000    0.765
N14.T1     0.000    0.765
N1.T2      0.001    0.736
N2.T2      0.001    0.736
N3.T2      0.001    0.736
N4.T2      0.001    0.736
N5.T2      0.001    0.736
N6.T2      0.001    0.736
N7.T2      0.001    0.736
N8.T2      0.001    0.736
N9.T2      0.001    0.736
N10.T2     0.001    0.736
N11.T2     0.001    0.736
N12.T2     0.001    0.736
N13.T2     0.001    0.736
N14.T2     0.001    0.736
N1.T3      0.001    0.714
N2.T3      0.001    0.714
N3.T3      0.001    0.714
N4.T3      0.001    0.714
N5.T3      0.001    0.714
N6.T3      0.001    0.714
N7.T3      0.001    0.714
N8.T3      0.001    0.714
N9.T3      0.001    0.714
N10.T3     0.001    0.714
N11.T3     0.001    0.714
N12.T3     0.001    0.714
N13.T3     0.001    0.714
N14.T3     0.001    0.714
N1.T4      0.001    0.712
N2.T4      0.001    0.712
N3.T4      0.001    0.712
N4.T4      0.001    0.712
N5.T4      0.001    0.712
N6.T4      0.001    0.712
N7.T4      0.001    0.712
N8.T4      0.001    0.712
N9.T4      0.001    0.712
N10.T4     0.001    0.712
N11.T4     0.001    0.712
N12.T4     0.001    0.712
N13.T4     0.001    0.712
N14.T4     0.001    0.712
N1.T5      0.000    0.698
N2.T5      0.000    0.698
N3.T5      0.000    0.698
N4.T5      0.000    0.698
N5.T5      0.000    0.698
N6.T5      0.000    0.698
N7.T5      0.000    0.698
N8.T5      0.000    0.698
N9.T5      0.000    0.698
N10.T5     0.000    0.698
N11.T5     0.000    0.698
N12.T5     0.000    0.698
N13.T5     0.000    0.698
N14.T5     0.000    0.698
N1.T6      0.002    0.688
N2.T6      0.002    0.688
N3.T6      0.002    0.688
N4.T6      0.002    0.688
N5.T6      0.002    0.688
N6.T6      0.002    0.688
N7.T6      0.002    0.688
N8.T6      0.002    0.688
N9.T6      0.002    0.688
N10.T6     0.002    0.688
N11.T6     0.002    0.688
N12.T6     0.002    0.688
N13.T6     0.002    0.688
N14.T6     0.002    0.688
N1.T7      0.102    0.677
N2.T7      0.102    0.677
N3.T7      0.102    0.677
N4.T7      0.102    0.677
N5.T7      0.102    0.677
N6.T7      0.102    0.677
N7.T7      0.102    0.677
N8.T7      0.102    0.677
N9.T7      0.102    0.677
N10.T7     0.102    0.677
N11.T7     0.102    0.677
N12.T7     0.102    0.677
N13.T7     0.102    0.677
N14.T7     0.102    0.677
N1.T8      0.346    0.710
N2.T8      0.346    0.710
N3.T8      0.346    0.710
N4.T8      0.346    0.710
N5.T8      0.346    0.710
N6.T8      0.346    0.710
N7.T8      0.346    0.710
N8.T8      0.346    0.710
N9.T8      0.346    0.710
N10.T8     0.346    0.710
N11.T8     0.346    0.710
N12.T8     0.346    0.710
N13.T8     0.346    0.710
N14.T8     0.346    0.710
N1.T9      0.570    0.753
N2.T9      0.570    0.753
N3.T9      0.570    0.753
N4.T9      0.570    0.753
N5.T9      0.570    0.753
N6.T9      0.570    0.753
N7.T9      0.570    0.753
N8.T9      0.570    0.753
N9.T9      0.570    0.753
N10.T9     0.570    0.753
N11.T9     0.570    0.753
N12.T9     0.570    0.753
N13.T9     0.570    0.753
N14.T9     0.570    0.753
N1.T10     0.786    0.791
N2.T10     0.786    0.791
N3.T10     0.786    0.791
N4.T10     0.786    0.791
N5.T10     0.786    0.791
N6.T10     0.786    0.791
N7.T10     0.786    0.791
N8.T10     0.786    0.791
N9.T10     0.786    0.791
N10.T10    0.786    0.791
N11.T10    0.786    0.791
N12.T10    0.786    0.791
N13.T10    0.786    0.791
N14.T10    0.786    0.791
N1.T11     0.920    0.829
N2.T11     0.920    0.829
N3.T11     0.920    0.829
N4.T11     0.920    0.829
N5.T11     0.920    0.829
N6.T11     0.920    0.829
N7.T11     0.920    0.829
N8.T11     0.920    0.829
N9.T11     0.920    0.829
N10.T11    0.920    0.829
N11.T11    0.920    0.829
N12.T11    0.920    0.829
N13.T11    0.920    0.829
N14.T11    0.920    0.829
N1.T12     0.986    0.861
N2.T12     0.986    0.861
N3.T12     0.986    0.861
N4.T12     0.986    0.861
N5.T12     0.986    0.861
N6.T12     0.986    0.861
N7.T12     0.986    0.861
N8.T12     0.986    0.861
N9.T12     0.986    0.861
N10.T12    0.986    0.861
N11.T12    0.986    0.861
N12.T12    0.986    0.861
N13.T12    0.986    0.861
N14.T12    0.986    0.861
N1.T13     1.000    0.879
N2.T13     1.000    0.879
N3.T13     1.000    0.879
N4.T13     1.000    0.879
N5.T13     1.000    0.879
N6.T13     1.000    0.879
N7.T13     1.000    0.879
N8.T13     1.000    0.879
N9.T13     1.000    0.879
N10.T13    1.000    0.879
N11.T13    1.000    0.879
N12.T13    1.000    0.879
N13.T13    1.000    0.879
N14.T13    1.000    0.879
N1.T14     0.955    0.877
N2.T14     0.955    0.877
N3.T14     0.955    0.877
N4.T14     0.955    0.877
N5.T14     0.955    0.877
N6.T14     0.955    0.877
N7.T14     0.955    0.877
N8.T14     0.955    0.877
N9.T14     0.955    0.877
N10.T14    0.955    0.877
N11.T14    0.955    0.877
N12.T14    0.955    0.877
N13.T14    0.955    0.877
N14.T14    0.955    0.877
N1.T15     0.823    0.868
N2.T15     0.823    0.868
N3.T15     0.823    0.868
N4.T15     0.823    0.868
N5.T15     0.823    0.868
N6.T15     0.823    0.868
N7.T15     0.823    0.868
N8.T15     0.823    0.868
N9.T15     0.823    0.868
N10.T15    0.823    0.868
N11.T15    0.823    0.868
N12.T15    0.823    0.868
N13.T15    0.823    0.868
N14.T15    0.823    0.868
N1.T16     0.616    0.856
N2.T16     0.616    0.856
N3.T16     0.616    0.856
N4.T16     0.616    0.856
N5.T16     0.616    0.856
N6.T16     0.616    0.856
N7.T16     0.616    0.856
N8.T16     0.616    0.856
N9.T16     0.616    0.856
N10.T16    0.616    0.856
N11.T16    0.616    0.856
N12.T16    0.616    0.856
N13.T16    0.616    0.856
N14.T16    0.616    0.856
N1.T17     0.352    0.845
N2.T17     0.352    0.845
N3.T17     0.352    0.845
N4.T17     0.352    0.845
N5.T17     0.352    0.845
N6.T17     0.352    0.845
N7.T17     0.352    0.845
N8.T17     0.352    0.845
N9.T17     0.352    0.845
N10.T17    0.352    0.845
N11.T17    0.352    0.845
N12.T17    0.352    0.845
N13.T17    0.352    0.845
N14.T17    0.352    0.845
N1.T18     0.102    0.834
N2.T18     0.102    0.834
N3.T18     0.102    0.834
N4.T18     0.102    0.834
N5.T18     0.102    0.834
N6.T18     0.102    0.834
N7.T18     0.102    0.834
N8.T18     0.102    0.834
N9.T18     0.102    0.834
N10.T18    0.102    0.834
N11.T18    0.102    0.834
N12.T18    0.102    0.834
N13.T18    0.102    0.834
N14.T18    0.102    0.834
N1.T19     0.001    0.834
N2.T19     0.001    0.834
N3.T19     0.001    0.834
N4.T19     0.001    0.834
N5.T19     0.001    0.834
N6.T19     0.001    0.834
N7.T19     0.001    0.834
N8.T19     0.001    0.834
N9.T19     0.001    0.834
N10.T19    0.001    0.834
N11.T19    0.001    0.834
N12.T19    0.001    0.834
N13.T19    0.001    0.834
N14.T19    0.001    0.834
N1.T20     0.000    0.951
N2.T20     0.000    0.951
N3.T20     0.000    0.951
N4.T20     0.000    0.951
N5.T20     0.000    0.951
N6.T20     0.000    0.951
N7.T20     0.000    0.951
N8.T20     0.000    0.951
N9.T20     0.000    0.951
N10.T20    0.000    0.951
N11.T20    0.000    0.951
N12.T20    0.000    0.951
N13.T20    0.000    0.951
N14.T20    0.000    0.951
N1.T21     0.000    1.000
N2.T21     0.000    1.000
N3.T21     0.000    1.000
N4.T21     0.000    1.000
N5.T21     0.000    1.000
N6.T21     0.000    1.000
N7.T21     0.000    1.000
N8.T21     0.000    1.000
N9.T21     0.000    1.000
N10.T21    0.000    1.000
N11.T21    0.000    1.000
N12.T21    0.000    1.000
N13.T21    0.000    1.000
N14.T21    0.000    1.000
N1.T22     0.000    0.924
N2.T22     0.000    0.924
N3.T22     0.000    0.924
N4.T22     0.000    0.924
N5.T22     0.000    0.924
N6.T22     0.000    0.924
N7.T22     0.000    0.924
N8.T22     0.000    0.924
N9.T22     0.000    0.924
N10.T22    0.000    0.924
N11.T22    0.000    0.924
N12.T22    0.000    0.924
N13.T22    0.000    0.924
N14.T22    0.000    0.924
N1.T23     0.001    0.869
N2.T23     0.001    0.869
N3.T23     0.001    0.869
N4.T23     0.001    0.869
N5.T23     0.001    0.869
N6.T23     0.001    0.869
N7.T23     0.001    0.869
N8.T23     0.001    0.869
N9.T23     0.001    0.869
N10.T23    0.001    0.869
N11.T23    0.001    0.869
N12.T23    0.001    0.869
N13.T23    0.001    0.869
N14.T23    0.001    0.869
N1.T24     0.000    0.765
N2.T24     0.000    0.765
N3.T24     0.000    0.765
N4.T24     0.000    0.765
N5.T24     0.000    0.765
N6.T24     0.000    0.765
N7.T24     0.000    0.765
N8.T24     0.000    0.765
N9.T24     0.000    0.765
N10.T24    0.000    0.765
N11.T24    0.000    0.765
N12.T24    0.000    0.765
N13.T24    0.000    0.765
N14.T24    0.000    0.765;


*Creacion de variables
VARIABLES
z funcion objetivo (Perdidas)
V(i,T) Variables de modulo de voltaje
d(i,T) Variables de angulo de voltaje
Pg(gc,T) Potencia activa generada por Gen. Conv.
Qg(gc,T) Potencia reactiva generada por Gen. Conv.
Pdg(i) Potencia activa generada por el DG
Qdg(i,T) Potencia reaactiva generada por el DG;
*limites de las variables
V.lo(i,T) = 0.9;
V.up(i,T) = 1.1;
V.fx('N2',T) = 1.05;
d.fx('N2',T) = 0.00;
V.fx('N9',T) = 1.05;
d.fx('N9',T) = 0.00;
V.fx('N11',T) = 1.10;
d.fx('N11',T) = 0.00;

BINARY VARIABLES
x(i) variable de localización optima del DG;

*Ecuaciones
EQUATIONS
FO Funcion obj.
BalP(i,T) Balance de potencia activa.
BalQ(i,T) Balance de potencia reactiva.
TGEN Numerdo de GD permitida
MAXPGD(i)
MINPGD(i)
MAXQGD(i,T)
MINQGD(i,T);

*Forma de las ecuaciones
FO.. z =E= SUM(T,SUM(i, V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))))));
BalP(i,T).. SUM(GC$MAP(gc,i), Pg(gc,T)) + SOL(i,T,'Ps')*Pdg(i) - SOL(i,T,'Pload')*DEM (i,'Pd') =E= V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))));
BalQ(i,T).. SUM(GC$MAP(gc,i), Qg(gc,T)) + qdg(i,T) - SOL(i,T,'Pload')*DEM (i,'Qd') =E= - V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*sin(d(j,T) - d(i,T)+ Y(i,j,'Phij'))));

TGEN.. SUM(i,x(i)) =L= NGmax;
MAXPGD(i).. Pdg(i) =G= 0;
MINPGD(i).. Pdg(i) =L= x(i)*PGmax;

MAXQGD(i,T).. qdg(i,T) =G= -(pdg(i)/n)*sqrt(1-(SQR(n*SOL(i,T,'Ps'))));
MINQGD(i,T).. qdg(i,T) =L=  (pdg(i)/n)*sqrt(1-(SQR(n*SOL(i,T,'Ps'))));


MODEL FlujodePot /ALL/;
OPTIONS decimals = 5;
SOLVE FlujodePot us MINLP min z;
DISPLAY V.l, d.l, Pg.l, Qg.l, x.l, pdg.l, qdg.l;



*** SISTEMA DE 27 NODOS

*Creacion conjuntos
SETS
i Conjunto de nodos /N1*N27/
gc Conjunto de generadores convencionales /GC1/
MAP (gc,i) Realacion GC con el nodo /GC1.N1/
T Conjunto de horas del dia /T1*T24/;
ALIAS (i,j);
SCALARS
PGmax Potencia maxima de salida por DG /10/
NGmax DG permitidos /0/
n cargabilidad /0.9/;

*Informacion del sistema
TABLE Y(i,j,*)
        Yij                   Phij
N1.N1   761.462124784423     -0.917179002736707
N2.N1   761.462124784423      2.22441365085309
N1.N2   761.462124784423      2.22441365085309
N2.N2   1154.10719913350     -0.805594753746366
N3.N2   214.264953172691      2.40442468091747
N11.N2  196.557882935451      2.70088759948518
N2.N3   214.264953172691      2.40442468091747
N3.N3   1117.94036705488     -0.685781014926634
N4.N3   714.216510575636      2.40442468091747
N17.N3  196.557882935451      2.70088759948518
N3.N4   714.216510575636      2.40442468091747
N4.N4   1274.95882344538     -0.633378207407227
N5.N4   373.439092343951      2.60572830306726
N22.N4  196.557882935451      2.70088759948518
N4.N5   373.439092343951      2.60572830306726
N5.N5   905.395526809909     -0.515235334884889
N6.N5   336.095183109556      2.60572830306726
N23.N5  196.557882935451      2.70088759948518
N5.N6   336.095183109556      2.60572830306726
N6.N6   1183.77810604434     -0.467684949082305
N7.N6   357.377968973546      2.70088759948518
N24.N6  491.394707338626      2.70088759948518
N6.N7   357.377968973546      2.70088759948518
N7.N7   553.935851908997     -0.440705054104618
N8.N7   196.557882935451      2.70088759948518
N7.N8   196.557882935451      2.70088759948518
N8.N8   1008.99713240198     -0.440705054104618
N9.N8   157.246306348360      2.70088759948518
N25.N8  327.596471559084      2.70088759948518
N26.N8  327.596471559084      2.70088759948518
N8.N9   157.246306348360      2.70088759948518
N9.N9   353.804189283811     -0.440705054104617
N10.N9  196.557882935451      2.70088759948518
N9.N10  196.557882935451      2.70088759948518
N10.N10 196.557882935451     -0.440705054104617
N2.N11  196.557882935451      2.70088759948518
N11.N11 356.361039793541     -0.440705054104618
N12.N11 159.803156858090      2.70088759948518
N11.N12 159.803156858090      2.70088759948518
N12.N12 421.880334105357     -0.440705054104617
N13.N12 262.077177247267      2.70088759948518
N12.N13 262.077177247267      2.70088759948518
N13.N13 613.073396774858     -0.440705054104617
N14.N13 350.996219527590      2.70088759948518
N13.N14 350.996219527590      2.70088759948518
N14.N14 547.554102463041     -0.440705054104617
N15.N14 196.557882935451      2.70088759948518
N14.N15 196.557882935451      2.70088759948518
N15.N15 393.115765870901     -0.440705054104617
N16.N15 196.557882935451      2.70088759948518
N15.N16 196.557882935451      2.70088759948518
N16.N16 196.557882935451     -0.440705054104617
N3.N17  196.557882935451      2.70088759948518
N17.N17 524.154354494535     -0.440705054104617
N18.N17 327.596471559084      2.70088759948518
N17.N18 327.596471559084      2.70088759948518
N18.N18 545.994119265141     -0.440705054104618
N19.N18 218.397647706056      2.70088759948518
N18.N19 218.397647706056      2.70088759948518
N19.N19 425.300682374952     -0.440705054104617
N20.N19 206.903034668895      2.70088759948518
N19.N20 206.903034668895      2.70088759948518
N20.N20 403.460917604346     -0.440705054104617
N21.N20 196.557882935451      2.70088759948518
N20.N21 196.557882935451      2.70088759948518
N21.N21 196.557882935451     -0.440705054104617
N4.N22  196.557882935451      2.70088759948518
N22.N22 196.557882935451     -0.440705054104617
N5.N23  196.557882935451      2.70088759948518
N23.N23 196.557882935451     -0.440705054104617
N6.N24  491.394707338626      2.70088759948518
N24.N24 491.394707338626     -0.440705054104617
N8.N25  327.596471559084      2.70088759948518
N25.N25 327.596471559084     -0.440705054104618
N8.N26  327.596471559084      2.70088759948518
N26.N26 573.293825228398     -0.440705054104617
N27.N26 245.697353669313      2.70088759948518
N26.N27 245.697353669313      2.70088759948518
N27.N27 245.697353669313     -0.440705054104617;

*Potencias ya en PU
TABLE DEM(i,*)
      Pd          Qd
N1    0.000       0.000
N2    0.000       0.000
N3    0.000       0.000
N4    0.297       0.184
N5    0.000       0.000
N6    0.255       0.158
N7    0.000       0.000
N8    0.212       0.131
N9    0.000       0.000
N10   0.266       0.164
N11   0.085       0.052
N12   0.340       0.210
N13   0.297       0.184
N14   0.191       0.118
N15   0.106       0.065
N16   0.025       0.158
N17   0.225       0.158
N18   0.127       0.079
N19   0.297       0.184
N20   0.340       0.210
N21   0.085       0.052
N22   0.106       0.065
N23   0.055       0.034
N24   0.069       0.043
N25   0.256       0.158
N26   0.063       0.039
N27   0.170       0.105;


*Uso la misma tabla SOL para el Pload que es la demanda variable en
*las 24 horas para no tener que crear otra variable

TABLE SOL(T,*)
          Ps       Pload
T1        0.0000   0.7650
T2        0.0010   0.7360
T3        0.0010   0.7140
T4        0.0010   0.7120
T5        0.0000   0.6980
T6        0.0020   0.6880
T7        0.1020   0.6770
T8        0.3460   0.7100
T9        0.5700   0.7530
T10       0.7860   0.7910
T11       0.9200   0.8290
T12       0.9860   0.8610
T13       1.0000   0.8790
T14       0.9550   0.8770
T15       0.8230   0.8680
T16       0.6160   0.8560
T17       0.3520   0.8450
T18       0.1020   0.8350
T19       0.0010   0.8340
T20       0.0000   0.9510
T21       0.0000   1.0000
T22       0.0000   0.9240
T23       0.0010   0.8690
T24       0.0000   0.7665;


*Creacion de variables
VARIABLES
z funcion objetivo (Perdidas)
V(i,T) Variables de modulo de voltaje
d(i,T) Variables de angulo de voltaje
Pg(gc,T) Potencia activa generada por Gen. Conv.
Qg(gc,T) Potencia reactiva generada por Gen. Conv.
Pdg(i) Potencia activa generada por el DG
Qdg(i,T) Potencia reaactiva generada por el DG;
*limites de las variables
V.lo(i,T) = 0.9;
V.up(i,T) = 1.1;
V.fx('N1',T) = 1.00;
d.fx('N1',T) = 0.00;


BINARY VARIABLES
x(i) variable de localización optima del DG;

*Ecuaciones
EQUATIONS
FO Funcion obj.
BalP(i,T) Balance de potencia activa.
BalQ(i,T) Balance de potencia reactiva.
TGEN Numerdo de GD permitida
MAXPGD(i)
MINPGD(i)
MAXQGD(i,T)
MINQGD(i,T);

*Forma de las ecuaciones
FO.. z =E= SUM(T,SUM(i, V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))))));
BalP(i,T).. SUM(GC$MAP(gc,i), Pg(gc,T)) + SOL(T,'Ps')*Pdg(i) - SOL(T,'Pload')*DEM (i,'Pd') =E= V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*cos(d(j,T) - d(i,T) + Y(i,j,'Phij'))));
BalQ(i,T).. SUM(GC$MAP(gc,i), Qg(gc,T)) + qdg(i,T) - SOL(T,'Pload')*DEM (i,'Qd') =E= - V(i,T)*(SUM (j,V(j,T)*Y(i,j,'Yij')*sin(d(j,T) - d(i,T) + Y(i,j,'Phij'))));

TGEN.. SUM(i,x(i)) =L= NGmax;
MAXPGD(i).. Pdg(i) =G= 0;
MINPGD(i).. Pdg(i) =L= x(i)*PGmax;

MAXQGD(i,T).. qdg(i,T) =G= -(pdg(i)/n)*sqrt(1-(SQR(n*SOL(T,'Ps'))));
MINQGD(i,T).. qdg(i,T) =L=  (pdg(i)/n)*sqrt(1-(SQR(n*SOL(T,'Ps'))));


MODEL FlujodePot /ALL/;
OPTIONS decimals = 5;
SOLVE FlujodePot us MINLP min z;
DISPLAY V.l, d.l, Pg.l, Qg.l, x.l, pdg.l, qdg.l;



